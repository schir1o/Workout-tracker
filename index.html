<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#000000">
<title>Darios Gym</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-user-select:none;user-select:none}
body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",system-ui,sans-serif;background:#000;color:#fff;padding:0;margin:0;overscroll-behavior:none;min-height:100vh}
.app{min-height:100vh;display:flex;flex-direction:column;background:#000}

/* Header */
.header{background:linear-gradient(135deg,#007AFF,#0051D5);padding:14px 16px;padding-top:calc(14px + env(safe-area-inset-top));position:fixed;top:0;left:0;right:0;z-index:100;box-shadow:0 1px 10px rgba(0,0,0,0.3)}
.header-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.header h1{font-size:26px;font-weight:700;letter-spacing:-0.5px}
.settings-btn{width:38px;height:38px;background:rgba(255,255,255,0.2);border:none;border-radius:10px;color:#fff;font-size:18px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.2s;backdrop-filter:blur(10px)}
.settings-btn:active{transform:scale(0.9);background:rgba(255,255,255,0.3)}

/* Navigation */
.nav{display:flex;gap:6px;align-items:center}
.nav-btn{background:rgba(255,255,255,0.15);backdrop-filter:blur(10px);border:none;color:#fff;padding:10px;border-radius:10px;font-size:18px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;min-width:44px;min-height:44px;transition:all 0.2s}
.nav-btn:active{background:rgba(255,255,255,0.25);transform:scale(0.95)}
.date-btn{flex:1;text-align:center;font-size:15px;font-weight:600;padding:10px 16px;position:relative}
.date-input{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer}

/* Content */
.content{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;padding:16px;padding-top:calc(140px + env(safe-area-inset-top));padding-bottom:30px;background:#000}

/* Cards & Exercises */
.exercise{background:#1c1c1e;border-radius:14px;padding:12px;margin-bottom:12px;border:1px solid #2c2c2e}
.exercise-header{display:flex;align-items:center;margin-bottom:12px;gap:8px}
.exercise-name{font-size:17px;font-weight:600;flex:1}
.muscle-tag{background:#007AFF;padding:4px 10px;border-radius:16px;font-size:11px;font-weight:600;white-space:nowrap}
.delete-btn{background:#FF3B30;border:none;color:#fff;width:36px;height:36px;border-radius:10px;font-size:18px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.2s}
.delete-btn:active{transform:scale(0.9)}

/* Sets */
.set{display:grid;grid-template-columns:38px 1fr 72px 46px;gap:6px;align-items:center;padding:8px;background:#2c2c2e;border-radius:10px;margin-bottom:6px;transition:all 0.2s}
.set.done{background:rgba(52,199,89,0.15);border:1px solid rgba(52,199,89,0.3)}
.set-num{width:38px;height:38px;background:#007AFF;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:15px}
.set.done .set-num{background:#34C759}
.input{background:#1c1c1e;border:1px solid #3a3a3c;border-radius:8px;padding:9px;color:#fff;font-size:16px;font-weight:500;text-align:center;width:100%;-webkit-appearance:none;transition:all 0.2s}
.input:focus{border-color:#007AFF;outline:none}
.check-btn{width:46px;height:40px;border-radius:10px;background:#2c2c2e;border:2px solid #3a3a3c;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:22px;transition:all 0.2s}
.check-btn.checked{background:#34C759;border-color:#34C759;color:#fff}

/* Empty State */
.empty{text-align:center;padding:60px 20px;color:#8E8E93}
.empty-icon{font-size:48px;margin-bottom:16px;opacity:0.5}
.empty-text{font-size:18px;font-weight:600;margin-bottom:8px}
.empty small{display:block;margin-top:4px;font-size:14px;opacity:0.7}

/* Add Button */
.add-btn{width:100%;padding:15px;background:#007AFF;border:none;border-radius:12px;color:#fff;font-size:16px;font-weight:600;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px;margin-top:16px;transition:all 0.2s}
.add-btn:active{transform:scale(0.98);background:#0051D5}

/* Modal */
.modal{position:fixed;inset:0;background:rgba(0,0,0,0.9);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);z-index:999;display:none;align-items:flex-end;padding:0}
.modal.open{display:flex}
.modal-content{background:#1c1c1e;border-radius:20px 20px 0 0;padding:20px;width:100%;max-height:85vh;overflow-y:auto;-webkit-overflow-scrolling:touch;padding-bottom:calc(20px + env(safe-area-inset-bottom));animation:slideUp 0.3s}
@keyframes slideUp{from{transform:translateY(100%)}to{transform:translateY(0)}}
.modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
.modal h3{font-size:22px;font-weight:700}
.close-modal{width:30px;height:30px;background:#3a3a3c;border:none;border-radius:50%;color:#fff;font-size:16px;display:flex;align-items:center;justify-content:center;cursor:pointer}
.form-group{margin-bottom:18px}
.label{display:block;margin-bottom:6px;font-size:12px;font-weight:600;color:#8E8E93;text-transform:uppercase;letter-spacing:0.5px}
input[type="text"],input[type="number"],input[type="password"],select{width:100%;padding:12px;background:#2c2c2e;border:1px solid #3a3a3c;border-radius:10px;color:#fff;font-size:16px;font-weight:400;-webkit-appearance:none;transition:all 0.2s}
input:focus,select:focus{border-color:#007AFF;outline:none}
select{cursor:pointer;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%238E8E93' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right 10px center;background-size:18px;padding-right:36px}
.modal-btn{width:100%;padding:14px;border:none;border-radius:10px;font-size:16px;font-weight:600;cursor:pointer;margin-bottom:8px;transition:all 0.2s}
.modal-btn.primary{background:#007AFF;color:#fff}
.modal-btn.secondary{background:#3a3a3c;color:#fff}
.modal-btn.danger{background:#FF3B30;color:#fff}
.modal-btn.success{background:#34C759;color:#fff}
.modal-btn:active{transform:scale(0.98)}

/* Settings Items */
.settings-section{margin-bottom:20px}
.settings-title{font-size:12px;font-weight:600;color:#8E8E93;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:10px;padding-left:4px}
.settings-item{background:#2c2c2e;border-radius:10px;padding:14px;margin-bottom:8px;display:flex;align-items:center;gap:10px;cursor:pointer;transition:all 0.2s}
.settings-item:active{background:#3a3a3c}
.settings-icon{width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px}
.settings-icon.export{background:#5E5CE6}
.settings-icon.import{background:#FF9500}
.settings-icon.github{background:#34C759}
.settings-info{flex:1}
.settings-name{font-size:15px;font-weight:600;margin-bottom:2px}
.settings-desc{font-size:12px;color:#8E8E93}
.settings-arrow{color:#3a3a3c;font-size:16px}

/* Responsive */
@media (max-width:375px){
.header h1{font-size:24px}
.set{grid-template-columns:36px 1fr 65px 44px;gap:6px}
.input{font-size:15px;padding:8px}
}
</style>
</head>
<body>
<div class="app">
<div class="header">
<div class="header-top">
<h1>üí™ Darios Gym</h1>
<button class="settings-btn" onclick="openSettings()">‚öôÔ∏è</button>
</div>
<div class="nav">
<button class="nav-btn" onclick="cd(-1)">‚Üê</button>
<div class="nav-btn date-btn" id="dd">
<span id="date-text"></span>
<input type="date" class="date-input" id="di" onchange="sd(this.value)">
</div>
<button class="nav-btn" onclick="cd(1)">‚Üí</button>
</div>
</div>

<div class="content" id="ex"></div>
</div>

<!-- Add Exercise Modal -->
<div class="modal" id="am" onclick="if(event.target.id=='am')cm('am')">
<div class="modal-content">
<div class="modal-header">
<h3>Neue √úbung</h3>
<button class="close-modal" onclick="cm('am')">√ó</button>
</div>
<div class="form-group">
<label class="label">Name</label>
<input type="text" id="nn" placeholder="z.B. Bankdr√ºcken" autocomplete="off">
</div>
<div class="form-group">
<label class="label">S√§tze</label>
<input type="number" id="ns" value="3" min="1" max="10" inputmode="numeric">
</div>
<div class="form-group">
<label class="label">Wiederholungen</label>
<input type="text" id="nr" value="8-12" placeholder="8-12" autocomplete="off">
</div>
<div class="form-group">
<label class="label">Typ</label>
<select id="nt">
<option value="kg">Gewicht (kg)</option>
<option value="m">Distanz (m)</option>
<option value="min">Zeit (min)</option>
</select>
</div>
<div class="form-group">
<label class="label">Muskelgruppe</label>
<select id="nm">
<option value="Brust">Brust</option>
<option value="R√ºcken">R√ºcken</option>
<option value="Beine">Beine</option>
<option value="Schultern">Schultern</option>
<option value="Arme">Arme</option>
<option value="Bauch">Bauch</option>
<option value="Cardio">Cardio</option>
<option value="Andere">Andere</option>
</select>
</div>
<button class="modal-btn primary" onclick="ae()">√úbung hinzuf√ºgen</button>
<button class="modal-btn secondary" onclick="cm('am')">Abbrechen</button>
</div>
</div>

<!-- Settings Modal -->
<div class="modal" id="sm" onclick="if(event.target.id=='sm')cm('sm')">
<div class="modal-content">
<div class="modal-header">
<h3>Einstellungen</h3>
<button class="close-modal" onclick="cm('sm')">√ó</button>
</div>
<div class="settings-section">
<div class="settings-title">Daten</div>
<div class="settings-item" onclick="xp()">
<div class="settings-icon export">üì§</div>
<div class="settings-info">
<div class="settings-name">Export</div>
<div class="settings-desc">Trainingsdaten als JSON exportieren</div>
</div>
<div class="settings-arrow">‚Ä∫</div>
</div>
<div class="settings-item" onclick="im()">
<div class="settings-icon import">üì•</div>
<div class="settings-info">
<div class="settings-name">Import</div>
<div class="settings-desc">Trainingsdaten aus JSON importieren</div>
</div>
<div class="settings-arrow">‚Ä∫</div>
</div>
</div>
<div class="settings-section">
<div class="settings-title">Synchronisation</div>
<div class="settings-item" onclick="cs()">
<div class="settings-icon github">‚òÅÔ∏è</div>
<div class="settings-info">
<div class="settings-name">GitHub Sync</div>
<div class="settings-desc" id="github-status">Automatische Synchronisation einrichten</div>
</div>
<div class="settings-arrow">‚Ä∫</div>
</div>
</div>
</div>
</div>

<script>
const $=id=>document.getElementById(id);
let dt=new Date().toISOString().split('T')[0];
let w={};

// Load/Save
function l(){try{w=JSON.parse(localStorage.getItem('w'))||{}}catch{}}
function s(){localStorage.setItem('w',JSON.stringify(w));if(localStorage.getItem('ght'))ghs()}

// Date
function fd(){
const d=new Date(dt+'T12:00');
const mo=['So','Mo','Di','Mi','Do','Fr','Sa'][d.getDay()];
$('date-text').textContent=`${mo}, ${d.getDate()}.${(d.getMonth()+1+'').padStart(2,'0')}.${d.getFullYear()}`;
$('di').value=dt;
}

function cd(n){
const d=new Date(dt+'T12:00');
d.setDate(d.getDate()+n);
dt=d.toISOString().split('T')[0];
fd();r();
}

function sd(v){dt=v;fd();r()}

// Render
function r(){
const k=dt;
const d=w[k];
let h='';
if(!d||!d.e||d.e.length===0){
h=`<div class="empty">
<div class="empty-icon">üèãÔ∏è‚Äç‚ôÇÔ∏è</div>
<div class="empty-text">Noch keine √úbungen</div>
<small>Starte dein Training mit dem Button unten</small>
</div>`;
}else{
d.e.forEach((x,i)=>{
const tp=x.t||'kg';
const ph=tp==='m'?'Meter':tp==='min'?'Min':'kg';
const ph2=tp==='kg'?'Wdh':'Zeit';
h+=`<div class="exercise">
<div class="exercise-header">
<div class="exercise-name">${x.n}</div>
<div class="muscle-tag">${x.m||'Andere'}</div>
<button class="delete-btn" onclick="if(confirm('√úbung wirklich l√∂schen?'))re(${i})">√ó</button>
</div>`;
x.s.forEach((s,j)=>{
h+=`<div class="set ${s.d?'done':''}">
<div class="set-num">${j+1}</div>
<input class="input" placeholder="${ph}" value="${s.w||''}" onchange="us(${i},${j},'w',this.value)" inputmode="${tp==='kg'?'decimal':'numeric'}">
<input class="input" placeholder="${ph2}" value="${s.r||''}" onchange="us(${i},${j},'r',this.value)" inputmode="numeric">
<button class="check-btn ${s.d?'checked':''}" onclick="tg(${i},${j})">${s.d?'‚úì':''}</button>
</div>`;
});
h+=`</div>`;
});
}
h+=`<button class="add-btn" onclick="$('am').classList.add('open')">‚ûï Neue √úbung</button>`;
$('ex').innerHTML=h;
}

// Update Set
function us(i,j,f,v){
const k=dt;
if(!w[k])w[k]={e:[]};
if(w[k].e[i]&&w[k].e[i].s[j]){
w[k].e[i].s[j][f]=v;
s();
}
}

// Toggle Done
function tg(i,j){
const k=dt;
if(w[k]&&w[k].e[i]&&w[k].e[i].s[j]){
w[k].e[i].s[j].d=!w[k].e[i].s[j].d;
s();r();
}
}

// Add Exercise
function ae(){
const n=$('nn').value.trim();
const st=parseInt($('ns').value)||3;
const rp=$('nr').value||'8-12';
const tp=$('nt').value||'kg';
const mg=$('nm').value||'Andere';
if(n){
const k=dt;
if(!w[k])w[k]={e:[]};
w[k].e.push({n,r:rp,t:tp,m:mg,s:Array(st).fill().map(()=>({w:'',r:'',d:0}))});
$('nn').value='';$('ns').value='3';$('nr').value='8-12';$('nt').value='kg';$('nm').value='Brust';
cm('am');s();r();
}
}

// Remove Exercise
function re(i){
const k=dt;
if(w[k]&&w[k].e){
w[k].e.splice(i,1);
if(w[k].e.length===0)delete w[k];
s();r();
}
}

// Modal Functions
function cm(i){$(i).classList.remove('open')}
function openSettings(){
updateGithubStatus();
$('sm').classList.add('open');
}

function updateGithubStatus(){
const status = $('github-status');
if(status && localStorage.getItem('ght')){
const lastSync = localStorage.getItem('gls');
if(lastSync){
const date = new Date(lastSync);
const time = date.toLocaleTimeString('de', {hour: '2-digit', minute: '2-digit'});
const day = date.toLocaleDateString('de', {day: '2-digit', month: '2-digit'});
status.innerHTML = `‚úÖ Aktiv ‚Ä¢ Sync: ${day} ${time}`;
} else {
status.textContent = '‚úÖ Aktiviert';
}
} else {
status.textContent = 'Automatische Synchronisation einrichten';
}
}

// Export
function xp(){
cm('sm');
const d=JSON.stringify(w,null,2);
const b=new Blob([d],{type:'application/json'});
const u=URL.createObjectURL(b);
const a=document.createElement('a');
a.href=u;
a.download=`gym-${dt}.json`;
a.click();
}

// Import
function im(){
cm('sm');
const i=document.createElement('input');
i.type='file';
i.accept='.json';
i.onchange=e=>{
const r=new FileReader();
r.onload=ev=>{
try{
w=JSON.parse(ev.target.result);
s();r();alert('‚úÖ Import erfolgreich!');
}catch{alert('‚ùå Fehler beim Import')}
};
r.readAsText(e.target.files[0]);
};
i.click();
}

// GitHub Dialog
function cs(){
cm('sm');
setTimeout(()=>{
const m=document.createElement('div');
m.className='modal open';
m.onclick=e=>{if(e.target===m)m.remove()};
m.innerHTML=`<div class="modal-content">
<div class="modal-header">
<h3>GitHub Sync</h3>
<button class="close-modal" onclick="this.parentElement.parentElement.parentElement.remove()">√ó</button>
</div>
<div class="form-group"><label class="label">Token</label><input type="password" id="gt" placeholder="ghp_..." value="${localStorage.getItem('ght')||''}" autocomplete="off"></div>
<div class="form-group"><label class="label">Username</label><input type="text" id="gu" placeholder="dein-username" value="${localStorage.getItem('ghu')||''}" autocomplete="off"></div>
<div class="form-group"><label class="label">Repository</label><input type="text" id="gr" placeholder="Workout-tracker" value="${localStorage.getItem('ghr')||'Workout-tracker'}" autocomplete="off"></div>
<button class="modal-btn primary" onclick="gss()">Speichern & Aktivieren</button>
${localStorage.getItem('ght')?'<button class="modal-btn success" onclick="ghl().then(()=>{r();alert(\'‚úÖ Von GitHub geladen\')})">Von GitHub laden</button>':''}
${localStorage.getItem('ght')?'<button class="modal-btn danger" onclick="if(confirm(\'GitHub Sync wirklich deaktivieren?\')){localStorage.removeItem(\'ght\');localStorage.removeItem(\'ghu\');localStorage.removeItem(\'ghr\');alert(\'Deaktiviert\');this.parentElement.parentElement.remove()}">Deaktivieren</button>':''}
<button class="modal-btn secondary" onclick="this.parentElement.parentElement.remove()">Abbrechen</button>
</div>`;
document.body.appendChild(m);
},100);
}

function gss(){
try{
const t=$('gt').value,u=$('gu').value,r=$('gr').value;
if(t&&u){
localStorage.setItem('ght',t);
localStorage.setItem('ghu',u);
localStorage.setItem('ghr',r);
ghl().then(()=>{r();ghs()});
alert('‚úÖ Aktiviert');
const modal=document.querySelector('.modal.open');
if(modal)modal.remove();
}
}catch(e){
console.log('GitHub save error:',e);
alert('Fehler beim Speichern');
}
}

async function ghs(){
const t=localStorage.getItem('ght'),u=localStorage.getItem('ghu'),r=localStorage.getItem('ghr')||'Workout-tracker';
if(!t||!u)return;
try{
const d=btoa(unescape(encodeURIComponent(JSON.stringify({w,d:new Date()}))));
const s=await gsha();
await fetch(`https://api.github.com/repos/${u}/${r}/contents/data.json`,{
method:'PUT',
headers:{'Authorization':`token ${t}`},
body:JSON.stringify({message:`Update ${new Date().toLocaleString('de')}`,content:d,sha:s})
});
localStorage.setItem('gls', new Date().toISOString());
updateGithubStatus();
}catch(e){console.log('GitHub save error:',e)}
}

async function gsha(){
const t=localStorage.getItem('ght'),u=localStorage.getItem('ghu'),r=localStorage.getItem('ghr')||'Workout-tracker';
try{
const res=await fetch(`https://api.github.com/repos/${u}/${r}/contents/data.json`,{
headers:{'Authorization':`token ${t}`}
});
if(res.ok)return(await res.json()).sha;
}catch{}
}

async function ghl(){
const t=localStorage.getItem('ght'),u=localStorage.getItem('ghu'),r=localStorage.getItem('ghr')||'Workout-tracker';
if(!t||!u)return;
try{
const res=await fetch(`https://api.github.com/repos/${u}/${r}/contents/data.json`,{
headers:{'Authorization':`token ${t}`}
});
if(res.ok){
const d=await res.json();
const c=JSON.parse(decodeURIComponent(escape(atob(d.content))));
if(c.w){
w=c.w;
localStorage.setItem('w',JSON.stringify(w));
localStorage.setItem('gls', new Date().toISOString());
updateGithubStatus();
console.log('‚úÖ Von GitHub geladen');
}
}else if(res.status===404){
console.log('üìù Erstelle neue data.json mit leeren Daten');
w={};
await ghs();
}
}catch(e){console.log('GitHub load error:',e)}
}

// Init
fd();
if(localStorage.getItem('ght')){
ghl().then(()=>r());
}else{
l();
r();
}

// iOS optimizations
document.addEventListener('touchmove',e=>{if(e.scale!==1)e.preventDefault()},{passive:false});
</script>
</body>
</html>
